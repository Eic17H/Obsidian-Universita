# Query innestate

Query nidificate, cioè query la cui condizione è formulata usando il risultato di un'altra interrogazione (sub-query). Essenzialmente, possiamo dare un nome a una query, e usarla in un'altra query come se fosse una tabella.

## Operatori quantificati

### `ANY`

Ci sono operatori quantificati. Per esempio `ANY`, che restituisce `true` se almeno uno dei confronti della sub-query restituisce `true`, o qualcosa del genere... Non si capisce a parole, quindi usiamo un esempio.

```
SELECT Cognome, Nome
FROM Studenti
WHERE Matricola = ANY (SELECT Studente
					   FROM Esami
					   WHERE Corso = 'C3')
```

Questo `ANY` prende *tutti* i record che risultano dalla sub-query.

Allora anzi no questo tutor è incomprensibile, ho capito. Questo `WHERE Matricola = ANY X` significa `WHERE Matricola = X[0] || Matricola = X[1] || ...`, essenzialmente restituisce `true` se, dato l'insieme a destra di `ANY`, almeno un elemento dell'insieme se messo al posto di `ANY X` dà `true`.

La stessa operazione si può fare con una `JOIN`.

### `ALL`

È come `ANY` ma con `and` anziché `or`.

Per esempio, trovare l'elemento più basso in un insieme:

```
SELECT *
FROM Studenti
WHERE Anno <= ALL (SELECT Anno
				   FROM Studenti)
```

### `IN`

`IN` è molto simile a `ANY`. Se ho capito bene è uguale a `= ANY`.

Si può combinare con `NOT` creando `NOT IN`.

## Operatori esistenziali

### `EXISTS`

Restituisce `true` se la sub-query non dà un insieme vuoto.

Chiaramente c'è anche il `NOT EXISTS`.

## Sub-query correlata

Una sub-query correlata è una sub-query che usa riferimenti a tabelle della query di ordine superiore.

## Scope

Strumenti per la pulizia di pavimenti…? Scherzi a parte. Una sub-query vede lo scope della query al livello superiore, ma non il contrario. Quindi può servire invertire query e sub-query per usare lo scopo di una nell'altra.

All'esame potremo trovare sub-query dentro sub-query, o sub-query affiancate.