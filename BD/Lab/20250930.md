SQL. Di nuovo. Sì da FPW.

Ci sono vari tipi con anche alias. Char/character, integer/numeric, serial, bigserial. Serial e bigserial quando vengono creati vengono assegnati in modo incrementale, e se si cancella un'entry non si riusa lo stesso seriale. Timestamp, interval, data sono tipi di tempo. Ci sono diversi stili per rappresentare le date in stringhe, si può decidere con SET date_style. C'è Boolean che può essere TRUE, FALSE e NULL. Vedi le slide ovviamente il solito, si capisce.

Apri PGAdmin. A sinistra, apri a tendina Servers, poi PostgreSQL. Clic destro su Databases e crea BDLab2025. In un database possiamo mettere più schemi. Di default ti crea lo schema public. Puoi crearne uno col tasto destro, o col tasto Query Tool, che è ciò che useremo. Il query tool è ciò che ci permette di usare comandi in linguaggio SQL.

```
CREATE SCHEMA tutoraggio;
```

Non premere `Ctrl+S`, quello ti salva la query in un file. Premi invece play.


```
CREATE SCHEMA

Query returned successfully in 31 msec.
```

Bene, ha funzionato. Clic destro, refresh, e vedi che c'è il nuovo schema oltre a public.

Clic destro sul database e creiamo un backup. Formato Plain, il resto lascia default. Compaiono messaggi in basso a destra. Verde se va a buon fine, rosso se non va a buon fine, e comunque rosso certe volte anche se va a buon fine, e va be', peccato.

Ovviamente usiamo SQL come linguaggio. Ha avuto tante versioni, lasciamo perdere la storia perché non c'è all'esame. Una delle tre funzioni principali è la definizione di dati, che si fa con l'istruzione CREATE. (Nota, i domini sono tipi custom). Per creare la tabella impiegato:

```
CREATE TABLE Impiegato
( Matricola CHAR(6) PRIMARY KEY,
Nome VARCHAR(20) NOT NULL,
...
Stipendio DECIMAL(10,2) DEFAULT 0,
  FOREGIN KEY(Dipartimento)
  REFERENCES Dipartimento(NomeDip),
  UNIQUE (Cognome, Nome)
);
```

Qua vediamo un paio di campi con tipi diversi e valori default o vincoli. Mi sono perso va be'.

NULL è un valore compatibile con tutti i tipi di dato, si usa per rappresentare "non lo so". Ah no aspetta ora dice che i bool hanno TRUE FALSE UNKNOWN, che sta dicendo. O magari boh sono sinonimi? Veramente una spiegazione poco chiara, non so se se ne rende conto.

UNKNOWN con gli operatori logici? Ha anche senso. TRUE AND UNKOWN è UNKNOWN ovviamente, ma FALSE AND UNKOWN, a prescindere dal secondo è FALSE. Al contrario con OR. NOT UNKOWN è UNKNOWN. Ha senso se lo dici a parole.

Ma quindi cos'è uno schema? Diciamo che è essenzialmente una cartella con dentro delle tabelle.

Diciamo che abbiamo creato lo schema dipartimento, minuscolo perché con la maiuscola boh SQL ha deciso di fare le bizze.

Domini. Tipi custom.

```
SET SCHEMA 'dipartimento';
CREATE DOMAIN Voto AS SMALLINT
DEFAULT NULL
CHECK ( value >= 18 AND value <= 30 );
```

Un altro esempio

```
SET SCHEMA 'dipartimento';
CREATE DOMAIN AnniCorso AS SMALLINT
DEFAULT 3
NOT NULL;
```

Esercizio: dominio codice fiscale di lunghezza 16. Se metti una stringa più corta in una variabile lunga vengono messi automaticamente spazi vuoti alla fine.

```
SET SCHEMA 'dipartimento';
CREATE DOMAIN CodiceFiscale AS CHAR(16)
DEFAULT NULL
CHECK ( LENGTH(value) = 16 );
```

Se non specifichi lo schema te lo mette in public.

Per convenzione, KEYWORD, Identificatori, identificatori. È "solo" una convenzione, ma le convenzioni sono importanti quindi rispettala.

Le autorizzazioni dello schema sono nelle slide e, crucialmente, **non** nell'esame. Wow.

Creiamo una tabella: vedi le slide.

PRIMARY KEY non può essere NULL e deve essere unica.

Ci sono esercizi che non farò.

Vedi le slide non ho più voglia ti giuro. Belli i vincoli però.
